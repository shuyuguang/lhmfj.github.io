<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Felotus</title>
    
    <!-- [修改] 引入拆分后的 CSS 文件 -->
    <link rel="stylesheet" href="styles/global.css">
    <link rel="stylesheet" href="styles/layout.css">
    <link rel="stylesheet" href="styles/sidebar.css">
    <link rel="stylesheet" href="styles/pages.css">
    <link rel="stylesheet" href="styles/page-overlays.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/modals.css">
    <link rel="stylesheet" href="styles/chat.css">
    <link rel="stylesheet" href="statusBar.css">

    <!-- 引入 Font Awesome 和 Cropper.js 的 CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.css">
</head>
<body>

    <div class="app-container">
        <div id="status-bar-container"></div>

        <!-- 侧边栏菜单 -->
        <div class="sidebar-menu">
            <div class="sidebar-background"></div>
            <div class="sidebar-content">
                <div class="sidebar-top-actions">
                    <button class="action-btn"><i class="fa-solid fa-calendar-day"></i> 纪念日</button>
                    <button class="action-btn">
                        <i class="fa-solid fa-arrows-rotate"></i> 切换人设
                    </button>
                    <button class="action-btn" id="close-sidebar-btn"><i class="fa-solid fa-xmark"></i></button>
                </div>
                
                <div class="sidebar-profile-card" id="sidebar-profile-link"> 
                    <div class="profile-info">
                        <img src="https://i.imgur.com/Jz9v5aB.png" alt="avatar" class="avatar">
                        <div class="profile-details">
                            <div class="profile-name">用户</div>
                            <div class="profile-status">我的心是旷野的鸟，在你的眼…</div>
                        </div>
                        <i class="fa-solid fa-chevron-right"></i>
                    </div>
                </div>

                <div class="sidebar-nav-list">
                    <a href="#" class="nav-item" id="sidebar-api-link"><i class="fa-solid fa-plug"></i><span>API</span><i class="fa-solid fa-chevron-right"></i></a>
                    <a href="#" class="nav-item" id="sidebar-inject-link"><i class="fa-solid fa-wand-magic-sparkles"></i><span>注入</span><i class="fa-solid fa-chevron-right"></i></a>
                    <a href="#" class="nav-item" id="sidebar-favorites-link"><i class="fa-solid fa-star"></i><span>收藏</span><i class="fa-solid fa-chevron-right"></i></a>
                    <a href="#" class="nav-item" id="sidebar-beautify-link"><i class="fa-solid fa-palette"></i><span>美化</span><i class="fa-solid fa-chevron-right"></i></a>
                    <a href="#" class="nav-item" id="sidebar-wallet-link"><i class="fa-solid fa-wallet"></i><span>钱包</span><i class="fa-solid fa-chevron-right"></i></a>
                    <a href="#" class="nav-item" id="sidebar-special-link"><i class="fa-solid fa-gem"></i><span>特殊</span><i class="fa-solid fa-chevron-right"></i></a>
                    <a href="#" class="nav-item" id="sidebar-data-link"><i class="fa-solid fa-download"></i><span>数据</span><i class="fa-solid fa-chevron-right"></i></a>
                </div>

                <div class="sidebar-bottom-actions">
                    <button><i class="fa-solid fa-gear"></i><span>设置</span></button>
                    <button id="btn-open-weather-modal"><i class="fa-solid fa-cloud"></i><span>天气</span></button>
                    <button id="btn-open-location-modal"><i class="fa-solid fa-location-dot"></i><span>定位</span></button>
                </div>
            </div>
        </div>
        
        <div class="sidebar-overlay"></div>

        <div class="main-content-wrapper">
            <main class="main-content">
                <!-- 消息页面 -->
                <div id="page-messages" class="page active">
                    <header class="page-header">
                        <div class="user-info">
                            <img src="https://i.imgur.com/uG2g8xX.png" alt="avatar" class="avatar js-open-sidebar">
                            <div class="user-details-header">
                                <div class="header-username">用户</div>
                                <div class="header-status" id="header-status-trigger">
                                    <span id="header-status-text">在线</span>
                                </div>
                            </div>
                        </div>
                        <div class="header-actions">
                            <i class="fa-solid fa-plus" id="header-plus-btn"></i>
                        </div>
                        <div class="popover-menu" id="header-popover-menu">
                            <div class="popover-item" id="btn-create-character">
                                <i class="fa-solid fa-user-plus"></i>
                                <span>创建角色</span>
                            </div>
                            <div class="popover-item"><i class="fa-solid fa-users"></i><span>创建群聊</span></div>
                            <div class="popover-item"><i class="fa-solid fa-check-double"></i><span>一键多选</span></div>
                        </div>
                    </header>
                    <div class="search-bar messages-search-bar">
                        <i class="fa-solid fa-magnifying-glass"></i>
                        <span>搜索</span>
                    </div>
                    <div class="chat-list"></div>
                </div>

                <!-- 角色页面 -->
                <div id="page-contacts" class="page">
                    <header class="page-header"><div class="page-title js-open-sidebar">角色</div><div class="header-actions"><i class="fa-solid fa-ellipsis-vertical"></i></div></header>
                    <div class="search-bar contacts-search-bar"><i class="fa-solid fa-magnifying-glass"></i><span>搜索</span></div>
                    <div class="contact-groups">
                        <div class="group-item new-friend-group-item"><div class="group-header new-friend-item"><div>新朋友</div><i class="fa-solid fa-chevron-right"></i></div></div>
                        <div class="contact-tabs"><button class="contact-tab-btn active" data-target="tab-content-groups">分组</button><button class="contact-tab-btn" data-target="tab-content-group-chats">群聊</button></div>
                        <div class="tab-content-wrapper">
                            <div id="tab-content-groups" class="contact-tab-content active">
                                <div class="group-item">
                                    <div class="group-header"><div><i class="fa-solid fa-chevron-right"></i> <span class="group-name">特别关心</span></div><span class="group-count">0</span></div>
                                </div>
                                <div class="group-item">
                                    <div class="group-header"><div><i class="fa-solid fa-chevron-right"></i> <span class="group-name">默认分组</span></div><span class="group-count" id="default-group-count">0</span></div>
                                    <div class="contact-list" id="default-group-contacts"></div>
                                </div>
                            </div>
                            <div id="tab-content-group-chats" class="contact-tab-content">
                                <div class="group-item"><div class="group-header"><div><i class="fa-solid fa-chevron-right"></i> <span class="group-name">我创建的群聊</span></div><span class="group-count">1</span></div></div>
                                <div class="group-item"><div class="group-header"><div><i class="fa-solid fa-chevron-right"></i> <span class="group-name">我加入的群聊</span></div><span class="group-count">1</span></div></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 组件页面 -->
                <div id="page-tools" class="page">
                    <header class="page-header"><div class="page-title js-open-sidebar">组件</div></header>
                    <div class="tools-page-content">
                        <div class="tool-category">
                            <h3 class="tool-category-title">功能类</h3>
                            <div class="actions-grid"><div class="action-item"><i class="fa-solid fa-book-open"></i><span>小说</span></div><div class="action-item"><i class="fa-solid fa-music"></i><span>音乐</span></div><div class="action-item"><i class="fa-solid fa-book-journal-whills"></i><span>日记</span></div><div class="action-item"><i class="fa-solid fa-users-line"></i><span>菲洛图论坛</span></div><div class="action-item"><i class="fa-solid fa-hourglass-half"></i><span>专注陪伴</span></div><div class="action-item"><i class="fa-solid fa-map-pin"></i><span>记忆点</span></div></div>
                        </div>
                        <div class="tool-category">
                            <h3 class="tool-category-title">休闲类</h3>
                            <div class="actions-grid"><div class="action-item"><i class="fa-solid fa-egg"></i><span>扭蛋</span></div><div class="action-item"><i class="fa-solid fa-leaf"></i><span>农场</span></div><div class="action-item"><i class="fa-solid fa-paw"></i><span>宠物</span></div><div class="action-item"><i class="fa-solid fa-utensils"></i><span>烹饪</span></div></div>
                        </div>
                        <div class="tool-category">
                            <h3 class="tool-category-title">桌游类</h3>
                            <div class="actions-grid"><div class="action-item"><i class="fa-solid fa-user-secret"></i><span>谁是卧底</span></div><div class="action-item"><i class="fa-solid fa-moon"></i><span>狼人杀</span></div><div class="action-item"><i class="fa-solid fa-comments"></i><span>真心话</span></div><div class="action-item"><i class="fa-solid fa-plane"></i><span>飞行棋</span></div></div>
                        </div>
                    </div>
                </div>

                <!-- 长生树页面 -->
                <div id="page-tree" class="page">
                    <header class="page-header"><div class="page-title js-open-sidebar">长生树</div></header>
                    <div class="tree-container"><i class="fa-solid fa-tree"></i><p>长生树功能待开发...</p></div>
                </div>

                <!-- 动态页面 -->
                <div id="page-feed" class="page">
                    <header class="page-header"><div class="page-title js-open-sidebar">动态</div><div class="header-actions"><i class="fa-solid fa-gear"></i></div></header>
                    <div class="feed-content">
                        <div class="feed-profile-banner">
                            <img src="https://i.imgur.com/uG2g8xX.png" alt="avatar" class="avatar" id="feed-avatar">
                            <div class="feed-user-info"><span>用户</span></div><i class="fa-solid fa-chevron-right"></i>
                        </div>
                        <div class="actions-grid"><div class="action-item"><i class="fa-solid fa-image"></i><span>带图片</span></div><div class="action-item"><i class="fa-solid fa-comment-dots"></i><span>仅文字</span></div><div class="action-item"><i class="fa-solid fa-grip"></i><span>更多</span></div></div>
                        <div class="feed-card"><div class="feed-card-header"><img src="https://picsum.photos/seed/user5/100/100" alt="avatar"><div class="author-info"><div class="author-name">测试</div><div class="post-time">今天 12:00</div></div><i class="fa-solid fa-ellipsis"></i></div><div class="feed-card-body"><p>这是一条测试帖子</p><div class="shared-content">测试转发内容样式，功能还没做</div></div></div>
                    </div>
                </div>
            </main>

            <nav class="bottom-nav">
                <button class="nav-button active" data-target="page-messages"><i class="fa-solid fa-comment-dots"></i></button>
                <button class="nav-button" data-target="page-contacts"><i class="fa-solid fa-address-book"></i></button>
                <button class="nav-button" data-target="page-tree"><i class="fa-solid fa-tree"></i></button>
                <button class="nav-button" data-target="page-tools"><i class="fa-solid fa-toolbox"></i></button>
                <button class="nav-button" data-target="page-feed"><i class="fa-solid fa-star"></i></button>
            </nav>
        </div>

        <!-- [修改] 所有页面覆盖层(page-overlay)都已被移除，将由JS动态加载 -->
        <!-- 例如：用户设置页面之前在这里，现在已经移动到 templates/user-settings.html -->
        
        <!-- 天气、定位、状态等模态框 -->
        <div class="modal-overlay-container" id="modal-container">
            <div class="modal-panel" id="weather-modal">
                <div class="modal-header"><h3>选择天气</h3><button class="modal-close-btn"><i class="fa-solid fa-xmark"></i></button></div>
                <div class="modal-content"><div class="weather-grid" id="weather-options-grid"></div></div>
            </div>
            <div class="modal-panel" id="location-modal">
                <div class="modal-header"><h3>管理定位</h3><button class="modal-close-btn"><i class="fa-solid fa-xmark"></i></button></div>
                <div class="modal-content" id="location-cards-container"></div>
                <div class="modal-footer"><button class="modal-action-btn" id="btn-add-location"><i class="fa-solid fa-plus"></i> 添加新定位</button></div>
            </div>
            <div class="modal-panel" id="status-modal">
                <div class="modal-header"><h3>选择状态</h3><button class="modal-close-btn"><i class="fa-solid fa-xmark"></i></button></div>
                <div class="modal-content"><div class="status-grid" id="status-options-grid"></div></div>
            </div>
            <div class="modal-panel" id="clear-data-modal">
                <div class="modal-header"><h3>确认清除数据</h3><button class="modal-close-btn"><i class="fa-solid fa-xmark"></i></button></div>
                <div class="modal-content">
                    <p>此操作不可逆！将清除所有用户、角色、API及其他设置。</p>
                    <p>请输入 <strong>delete</strong> 以确认：</p>
                    <input type="text" id="clear-data-confirm-input" class="clear-data-input" autocomplete="off">
                </div>
                <div class="modal-footer"><button class="modal-action-btn danger" id="confirm-clear-data-btn" disabled>确认清除</button></div>
            </div>
            <div class="modal-panel" id="cropper-modal">
                <div class="modal-header"><h3>移动和缩放图片</h3><button class="modal-close-btn" id="cancel-crop-btn"><i class="fa-solid fa-xmark"></i></button></div>
                <div class="modal-content">
                    <div class="cropper-image-container">
                        <img id="image-to-crop" src="" alt="待剪裁的图片">
                    </div>
                </div>
                <div class="modal-footer cropper-footer"><button class="modal-action-btn" id="confirm-crop-btn">确认剪裁</button></div>
            </div> 
        </div>

    </div> <!-- End of app-container -->

    <!-- [修改] 脚本加载顺序 -->
    <script src="config.js"></script>
    <script src="DataManager.js"></script>
    <script src="UIManager.js"></script>
    <script src="App.js"></script>
    <script src="script.js"></script> 
    <script src="statusBar.js"></script> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.js"></script>
</body>
</html>